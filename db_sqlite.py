import sqlite3

class SQLiteDB:
    def __init__(self, db_file):
        self.conn = sqlite3.connect(db_file)
        self.cursor = self.conn.cursor()

    def create_table(self, table_name, columns):
        # 테이블 생성
        column_defs = ', '.join([f'{column[0]} {column[1]}' for column in columns])
        self.cursor.execute(f'CREATE TABLE IF NOT EXISTS {table_name} ({column_defs})')
        self.conn.commit()

    def insert_data(self, table_name, data):
        # 데이터 삽입
        placeholders = ', '.join(['?'] * len(data))
        self.cursor.execute(f'INSERT INTO {table_name} VALUES ({placeholders})', data)
        self.conn.commit()

    def read_data(self, table_name, query=None):
        # 데이터 조회
        if query:
            self.cursor.execute(f'SELECT * FROM {table_name} WHERE {query}')
        else:
            self.cursor.execute(f'SELECT * FROM {table_name}')
        return self.cursor.fetchall()

    def update_data(self, table_name, set_query, where_query):
        # 데이터 수정
        self.cursor.execute(f'UPDATE {table_name} SET {set_query} WHERE {where_query}')
        self.conn.commit()

    def delete_data(self, table_name, query):
        # 데이터 삭제
        self.cursor.execute(f'DELETE FROM {table_name} WHERE {query}')
        self.conn.commit()

    def close_connection(self):
        # 연결 종료
        self.conn.close()

# 예시 사용
db_file = 'excel_database.db'
db = SQLiteDB(db_file)

# 테이블 생성
table_name = 'Sheet1'
# columns = [('id', 'INTEGER PRIMARY KEY'), ('name', 'TEXT'), ('age', 'INTEGER')]
# db.create_table(table_name, columns)

# # 데이터 삽입
# data = (1, 'John Doe', 30)
# db.insert_data(table_name, data)

# 데이터 조회
query = 'a = 4'
result = db.read_data(table_name, query)
print(result)

# # 데이터 수정
# set_query = 'name = "Jane Doe"'
# where_query = 'id = 1'
# db.update_data(table_name, set_query, where_query)

# # 데이터 삭제
# query = 'id = 1'
# db.delete_data(table_name, query)

# 연결 종료
db.close_connection()



'''
a5a118cb6656ebe67f6146f95bc75e16dda04a590cd0fa8fcb394737d726985d83eacd83645747a99a6d11da736c8c5f5a69616f0fcc028d2220f4a3d2f7435547c87de14cf12fb458639fa9b603f5c7b7690898675f3470add833e9b419b1d49d3b4649d42c54bbbe3c8b118aa33b20aabcf524a10d234164f9d7eef43b4c99529bc41cb9853584dd600d86ecd0fa3415e315c0aa72ab277937793d5ba13ea2f2c0fc3c482feb572ed2ee7d0486581d2647f761a047f6da919f870f3db9b81e79f376f8399844313a131d39f9642a01261129621f85d8575f58b587b10f4d1a8d6edfe3453e43a204acc359dc4ff47886e2a13e951c79d0ab9dd1fc1119b99fcb1dbf7c87288d46e885c3f660847f7cd74989f75e6ae54317f681139a0764237cb377176f6abb8b706741ee3e2bac3670852a0225fea9e3bb8167bf721c7cce63430caabed42d4800cc20733b0ea43d9ae8339958a1704f32d47eb4ebbfc5d4eac9b3bfc73a464d90931ea088d4674d4e3cda4b6a7f13b0fb21a81abb06984b07863a8d11e8294004196deeb425cbf839273ae1f81e00839fb0a68f74db6732471cd3c5058e619947145531e2a7c84a45b1c2974f57ee9010009448bbb99eaf359e1e3272169927a0336a052851d4977864dc7ced523382ff2997942eee2fb309e46bf869109ff6420af57a6b01631eb51d98aaced5070c3ece08f45a5090a43c5a5e7250c23d01380e22d0d3985e8c624d7c2bc06d0b468fd2a0684bab93c024e9017cd95e4a5ae2325200b942cedba736cf1e5200210991d2ff46473d43e18e6c963e9ec57702fc2a9c07b297c23bd7c1be656caac16475bcc86a93d0999f5dace64982c4a38e6f1a70774e94ec28add57d9d85e4ae8d72fdff2a81cd9a33542ab749bb525ab8465ae48f3177c78db7dd3115f94fc4173a0e0258950fc6f6926624331d2939b4216da202aab16d59c31b728a5b71b2db73e5e17ce88c078893699f83c6013cdcaec4c5d7d2a4626c963bd766d9c08e0c7e468cddae93d65dacb8fce6b648988a3b614626c0763dfe36cbc205aaf00a91e05f5c3bd6da26fa996107011491a530791bd133cafef302d04cb7d2c5555bf06340df88a4f5bf1f58490d5a442fb7fe9140b33e51e45a321f84e9ded828daa2cd7edf216000495cb2404ca1fe65d7966d4dc8edd2940e4e6d4953061b126a2046252e5976f9860c981ff07eec948c4f01a5aa6bbb42fc8ad25d0b88fbe9f8715ff83bacf21c18e2077bf5dd07052360b6454f905e2744c288d624d3c844c5df08f41b424903bb9ed89ce00294d0164417e9383915f02fab09b863aace231257f951200adaf7698e0258d3e9e7883dac0c49d646b23501bb0d9e7cc9d71c5cfecf6c49cc65dec02c49819a5c67cc2ea01e5ab738bcbe9bdce27005344c1c8cb8e2302f8d70ff27cc9464a316aafaba3f64f5c34c8c621b693ab036d1da0af3f10793decedf1192e693c2918e1d0d88ca02a325eb8915849aecd1963cd0d8b2ea91f5696a60f8396d1049be29470a88a9bee0335339b3f579282952c5003fea33a13770cea07fe78906c321898ff8e43866c43039e1b65ce064498137686424426102fbc226bccc4bfa8972dcb3c255a75a06133d2502911e946cfe0941af3edf8735e617f0143f77a9c6d9653cac67d408554d7fc118e64c08446bc91eaf797a46b586386a31ecb5337c450649a509512afd9b042573b8d06fb9d940557514ccf10c5832f50f161641c9fb5183a226ce0e1b41bb40a199e028c90590848ba74ff5a2ee52cc24a40b5dc765da9718f60589b2f1421f1fc07566c3e8d2a3699c653b0e8d468c17ed660eae33309b85a48808027820df66c61b67f9287b87e4e9edcd7698b76f295d5de7eac31e5dee8a6b7ff9f66040739ea8c686c32c002e80190cbfe9a988694652c816b1019fd1ff29ac0f400956e170bac1d936246ace56ac04dd51d935b8baa73f9d49b3ca8c0c78563216ef29aa3df061e8b69ed8722b7837b1ec2704cd4aa1f8f17335caede1680d5b9de1bcb26b1d914d73096db12ccc3dd5626c5942c4b3196d6baf068b2d87e006226d7bea819732796d722d3ad4e24327c3cf8bb7084d4a6551be1ac6de077f442aef7c49c2d50e31482d8dd159de61a6631efa941c37911fbdc093101d17ca7d27230caab47b2ddd226dca7657f05742a01fcc85cc218faabde97281597eee8205bc024d4ce290397b52857b1c2afa991582a96a325007b33e0676231a9ae9da90fc739eb89ef46861ce8f0683eda320acbfe788d25fa83a38b966e98160bb3232417e805ccf5f4aac7b271ef4baecfb51774339081011cce0ab3a7860fa1786d934369bac5101cf0910dfb72cc25ed4691965b30d1a65f46f46892dd8320de61201dc45be2d85fb3f2ba098953768318ebfd62c7cf8711c6e10e4f16986b030a60d05114a13191f6682b9da1ca403c32e9ce3b59564266805ab3ced13cdae4f754e05ebed9857670a599e11b2c9463a87448573876a0708a0a1c63807b27aa9f4a1d4b3c09d142f80e4230cd7222d360fef3f03070cb7a6718e1ce4268bfe0b9e824965750c6e3786d4540e0e5c0127439aa00281849b9b02ce50800b71298074ce6163907096564a9acf30d7a996a0f7ed82cdda86c1b37b6c5b31115e679f751f49a1e9c45b1c60d03ff9193580a4256833216123696bac6eb75391eb6c83a0c6c1b2627430667af99e0fe7c84f58b4b5eb5a3c7573039810304aabc8294513f1e0c9d234c017ff48a6ab77899b463f4d501c4fe98ad89de1324af149486772218830f898a9f01c9719d631fcda6e9848d55500d7625bd670068489e17a05d248458741f5ec00c28e17ae5700ffe0a98184c79561b9c0a72be0a4bd096c9a71627fb5ed83efb446d744328ce3601cdc907362262376688a0be17c8d9a199fb82a3339dacab705c6e21711fba89a7466ec7e5c7effef7b979976a6c984db3c82dcd987990ee23008b680f534e72d1b589bee9bc6d25e038884ce5a83bcf1ed5ff3f5416e81664656ab1031a1f61602821607f962e4014a96397a482c4f36086a57fb6393bb0dea97130978d1d60803eaa7a6e734db41ff9b9415d242cb8a7abd898f12d0890ab9d1db7b86464445f335a97efe3216f9180fc7dfc0cc1519925a70b1b859879c5f14c7a239e8eb86da38b2087e8bd5a75295669c2df050ed1212d8120c3039357d7699efb90b449e7eda60e6fbfd3fcea5f54e246c6db4fdc0c6e819cb21c3f5e25707829ca19e791af56122ae9649056a17e6197dc5a5c955b1fe0d60732f793163f93cf0beab4f7636e2aeab7efcb0816d74a06d0b2a3d649fc8b644dbc4b15fbeced9395da24459ae862d68a79c2791695ee1438eb14259b116a12d7a00536a18bc72a45a8b530d86f4ff6103de
'''
